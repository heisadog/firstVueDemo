webpackJsonp([4],{"5Uab":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("qPwI"),a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yd-flexview"},[i("div",{staticClass:"g-scrollview"},[i("search",{attrs:{idx:5},on:{ongetdata:t.getsort,onsearch:t.searchfn}}),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"m-main os",staticStyle:{height:"-webkit-calc(100% - 200px)"}},[i("yd-pullrefresh",{ref:"pullrefreshDemo",attrs:{callback:t.loadList}},[i("yd-infinitescroll",{ref:"infinitescrollDemo",attrs:{callback:t.loadLists}},t._l(t.list,function(e,s){return i("yd-list",{key:s,attrs:{slot:"list",theme:"4"},slot:"list"},[t.hasRes?i("ul",{staticClass:"m-tab-cover m-tab-dtl",attrs:{"data-id":e.id,"data-mainid":e.mainid,"data-orderid":e.orderid}},[i("li",[i("img",{attrs:{slot:"img",src:e.mainpicurl,onerror:t.defaultImg},on:{click:function(i){t.showimg(e.mainpicurl)}},slot:"img"})]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.ordercode))]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.supplier))]),t._v(" "),i("li",{staticClass:"selflex",staticStyle:{color:"#3297fd"},on:{click:function(i){t.goDetail(e.id,e.mainid,e.orderid)}}},[i("u",[t._v(t._s(e.orderqty))])]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.contractdate))])]):t._e()])}))],1),t._v(" "),t.hasRes?t._e():i("pageError",{attrs:{msg:t.pageError}})],1)],1),t._v(" "),t.isshowbigimg?i("div",{staticClass:"yd-lightbox",on:{click:t.closebigimg}},[i("img",{attrs:{src:t.showbigimg,onerror:t.defaultImg,alt:""},on:{click:t.closebigimg}})]):t._e(),t._v(" "),i("div",{staticClass:"m-button"},[i("span",{staticClass:"m-but-master",on:{click:t.addEdit}},[t._v("发货")]),t._v(" "),i("span",{staticClass:"m-but-master",staticStyle:{"background-color":"#1664b3"},on:{click:t.submit}},[t._v("发货完全")])]),t._v(" "),i("foot",{attrs:{idx:4}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"m-tab m-tab-cover"},[i("li",[t._v("图片")]),t._v(" "),i("li",[t._v("追单编号")]),t._v(" "),i("li",[t._v("供应商")]),t._v(" "),i("li",[t._v("订货量")]),t._v(" "),i("li",[t._v("合同时间")])])}]},o=i("VU/8")(s.a,a,!1,null,null,null);e.default=o.exports},qPwI:function(t,e,i){"use strict";(function(t){var s=i("mvHQ"),a=i.n(s);e.a={data:function(){return{hasRes:!0,pageError:"暂无查询数据~",list:[],searchKey:"",searchSort:"desc",defaultImg:'this.src="'+i("Mcun")+'"',pageno:1,showbigimg:"",isshowbigimg:!1}},computed:{author:function(){return this.$store.state.author}},mounted:function(){this.getdata()},methods:{changeActive:function(e){t(".m-tab-dtl").eq(e).hasClass("check")?t(".m-tab-dtl").eq(e).removeClass("check"):t(".m-tab-dtl").eq(e).addClass("check")},searchfn:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getsort:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getdata:function(){var t=this,e=new D.FYBusiness("DOCUMENTARYTRACKINGLISTQRY"),i=e.addCreateService("DOCUMENTARYTRACKINGLISTQRY",!1),s=i.addCreateData();s.setValue("AS_USER_ID",localStorage.loginname),s.setValue("AS_DEPT_ID",""),s.setValue("AS_FUNC_NAME","DOCUMENTARYTRACKINGLISTQRY"),s.setValue("AS_CONDITION",t.searchKey),s.setValue("AS_SORT",t.searchSort),s.setValue("AS_OPRFLAG","5"),s.setValue("AN_PAGESIZE","20"),s.setValue("AN_PAGENO",t.pageno);var o=new D.InvokeProc;o.addBusiness(e),console.log(a()(o)),o.invoke(function(e){if("Y"==e.iswholeSuccess||"Y"==e.isAllBussSuccess){var s=i.getResult(e,"AC_RESULT").rows;console.log(s),0==s.length&&1==t.pageno?t.hasRes=!1:t.hasRes=!0,t.list=t.list.concat(s),t.$store.commit("ipdatestep5",s),t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad"),s.length<20&&t.pageno>1&&t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone")}else console.log(e.errorMessage),t.ydui.alert({mes:e.errorMessage})})},loadList:function(){var t=this;console.error("执行了下拉刷新获取数据"),this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata(),setTimeout(function(){t.$refs.pullrefreshDemo.$emit("ydui.pullrefresh.finishLoad")},1e3)},loadLists:function(){console.log("滚动加载了"),this.pageno++,this.getdata()},goDetail:function(t,e,i,s){this.$router.push({path:"/stepdtl",query:{id:t,footId:"4",mainid:e,orderid:i}})},submit:function(){var e=this,i=[],s=[],o=[];if(t(".m-main .m-tab-dtl").each(function(){t(this).hasClass("check")&&(i.push(t(this).attr("data-id")),s.push(t(this).attr("data-mainid")),o.push(t(this).attr("data-orderid")))}),0==i.length)return this.ydui.alert({mes:"请先选择商品"}),!1;for(var l=new D.FYBusiness("DOCUMENTARYTRACKINGSAVE"),r=l.addCreateService("DOCUMENTARYTRACKINGSAVE",!1),n=[],c=0;c<i.length;c++){var d={};d.AS_USER_ID=localStorage.loginname,d.AS_DEPT_ID="",d.AS_FUNC_NAME="DOCUMENTARYTRACKINGSAVE",d.AS_DTLID=i[c],d.AS_MAINID=s[c],d.AS_ORDERID=o[c],d.AS_FABRICACTUALARRIVEDATE="",d.AS_ACCESSORYACTUALARRIVEDATE="",d.AS_OPRFLAG="5",n.push(d)}r.addDataArray(n);var u=new D.InvokeProc;u.addBusiness(l),console.log(a()(u)),u.invoke(function(i){"Y"==i.iswholeSuccess||"Y"==i.isAllBussSuccess?(e.ydui.alert({mes:"发货成功"}),t(".m-main .m-tab-dtl").removeClass("check"),e.$store.commit("upstate",""),e.pageno=1,e.list=[],e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),e.getdata()):e.ydui.alert({mes:i.errorMessage})})},addEdit:function(){var e=0;if(t(".m-main .m-tab-dtl").each(function(){e=t(".check").length}),0==e)this.ydui.alert({mes:"请先选择商品"});else{var i=["add",t(".check").attr("data-id"),t(".check").attr("data-mainid"),t(".check").attr("data-orderid")],s=i[0],a=i[1],o=i[2],l=i[3];this.$router.push({path:"/edit",query:{footId:"4",type:s,id:a,mainid:o,orderid:l}})}},showimg:function(t){this.showbigimg=t,this.isshowbigimg=!0},closebigimg:function(){this.isshowbigimg=!1}}}}).call(e,i("7t+N"))}});