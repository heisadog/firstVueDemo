webpackJsonp([7],{"+StD":function(t,e,s){"use strict";(function(t){var i=s("mvHQ"),a=s.n(i);e.a={data:function(){return{hasRes:!0,pageError:"暂无查询数据~",list:[],searchKey:"",searchSort:"desc",defaultImg:'this.src="'+s("Mcun")+'"',pageno:1,showbigimg:"",isshowbigimg:!1}},computed:{author:function(){return this.$store.state.author}},mounted:function(){this.getdata()},methods:{changeActive:function(e){t(".m-tab-dtl").eq(e).hasClass("check")?t(".m-tab-dtl").eq(e).removeClass("check"):t(".m-tab-dtl").eq(e).addClass("check")},searchfn:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getsort:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getdata:function(){var t=this,e=new D.FYBusiness("DOCUMENTARYTRACKINGLISTQRY"),s=e.addCreateService("DOCUMENTARYTRACKINGLISTQRY",!1),i=s.addCreateData();i.setValue("AS_USER_ID",localStorage.loginname),i.setValue("AS_DEPT_ID",""),i.setValue("AS_FUNC_NAME","DOCUMENTARYTRACKINGLISTQRY"),i.setValue("AS_CONDITION",t.searchKey),i.setValue("AS_SORT",t.searchSort),i.setValue("AS_OPRFLAG","2"),i.setValue("AN_PAGESIZE","20"),i.setValue("AN_PAGENO",t.pageno);var l=new D.InvokeProc;l.addBusiness(e),console.log(a()(l)),l.invoke(function(e){if("Y"==e.iswholeSuccess||"Y"==e.isAllBussSuccess){var i=s.getResult(e,"AC_RESULT").rows;console.log(i),0==i.length&&1==t.pageno?t.hasRes=!1:t.hasRes=!0,t.list=t.list.concat(i),t.$store.commit("ipdatestep2",i),t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad"),i.length<20&&t.pageno>1&&t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone")}else console.log(e.errorMessage),t.ydui.alert({mes:e.errorMessage})})},loadList:function(){var t=this;console.error("执行了下拉刷新获取数据"),this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata(),setTimeout(function(){t.$refs.pullrefreshDemo.$emit("ydui.pullrefresh.finishLoad")},1e3)},loadLists:function(){console.log("滚动加载了"),this.pageno++,this.getdata()},goDetail:function(t,e,s){console.log(t),this.$router.push({path:"/stepdtl",query:{id:t,footId:"1",mainid:e,orderid:s}})},submit:function(){var e=this,s=[],i=[],l=[];if(t(".m-main .m-tab-dtl").each(function(){t(this).hasClass("check")&&(s.push(t(this).attr("data-id")),i.push(t(this).attr("data-mainid")),l.push(t(this).attr("data-orderid")))}),0==s.length)return this.ydui.alert({mes:"请先选择商品"}),!1;for(var o=new D.FYBusiness("DOCUMENTARYTRACKINGSAVE"),n=o.addCreateService("DOCUMENTARYTRACKINGSAVE",!1),r=[],c=0;c<s.length;c++){var d={};d.AS_USER_ID=localStorage.loginname,d.AS_DEPT_ID="",d.AS_FUNC_NAME="DOCUMENTARYTRACKINGSAVE",d.AS_DTLID=s[c],d.AS_MAINID=i[c],d.AS_ORDERID=l[c],d.AS_FABRICACTUALARRIVEDATE="",d.AS_ACCESSORYACTUALARRIVEDATE="",d.AS_OPRFLAG="2",r.push(d)}n.addDataArray(r);var u=new D.InvokeProc;u.addBusiness(o),console.log(a()(u)),u.invoke(function(s){"Y"==s.iswholeSuccess||"Y"==s.isAllBussSuccess?(e.ydui.alert({mes:"开裁成功"}),t(".m-main .m-tab-dtl").removeClass("check"),e.$store.commit("upstate",""),e.pageno=1,e.list=[],e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),e.getdata()):e.ydui.alert({mes:s.errorMessage})})},showimg:function(t){this.showbigimg=t,this.isshowbigimg=!0},closebigimg:function(){this.isshowbigimg=!1}}}}).call(e,s("7t+N"))},"5j/V":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("+StD"),a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"yd-flexview"},[s("div",{staticClass:"g-scrollview"},[s("search",{attrs:{idx:2},on:{ongetdata:t.getsort,onsearch:t.searchfn}}),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"m-main os",staticStyle:{height:"-webkit-calc(100% - 200px)"}},[s("yd-pullrefresh",{ref:"pullrefreshDemo",attrs:{callback:t.loadList}},[s("yd-infinitescroll",{ref:"infinitescrollDemo",attrs:{callback:t.loadLists}},t._l(t.list,function(e,i){return s("yd-list",{key:i,attrs:{slot:"list",theme:"4"},slot:"list"},[t.hasRes?s("ul",{staticClass:"m-tab-cover m-tab-dtl",attrs:{"data-id":e.id,"data-mainid":e.mainid,"data-orderid":e.orderid}},[s("li",[s("img",{attrs:{slot:"img",src:e.mainpicurl,onerror:t.defaultImg},on:{click:function(s){t.showimg(e.mainpicurl)}},slot:"img"})]),t._v(" "),s("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(i)}}},[t._v(t._s(e.ordercode))]),t._v(" "),s("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(i)}}},[t._v(t._s(e.supplier))]),t._v(" "),s("li",{staticClass:"selflex",staticStyle:{color:"#3297fd"},on:{click:function(s){t.goDetail(e.id,e.mainid,e.orderid)}}},[s("u",[t._v(t._s(e.orderqty))])]),t._v(" "),s("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(i)}}},[t._v(t._s(e.contractdate))])]):t._e()])}))],1),t._v(" "),t.hasRes?t._e():s("pageError",{attrs:{msg:t.pageError}})],1)],1),t._v(" "),t.isshowbigimg?s("div",{staticClass:"yd-lightbox",on:{click:t.closebigimg}},[s("img",{attrs:{src:t.showbigimg,onerror:t.defaultImg,alt:""},on:{click:t.closebigimg}})]):t._e(),t._v(" "),s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("开裁")])]),t._v(" "),s("foot",{attrs:{idx:1}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"m-tab m-tab-cover"},[s("li",[t._v("图片")]),t._v(" "),s("li",[t._v("追单编号")]),t._v(" "),s("li",[t._v("供应商")]),t._v(" "),s("li",[t._v("订货量")]),t._v(" "),s("li",[t._v("合同时间")])])}]},l=s("VU/8")(i.a,a,!1,null,null,null);e.default=l.exports}});