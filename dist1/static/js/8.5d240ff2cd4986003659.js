webpackJsonp([8],{Bp0h:function(t,e,i){"use strict";(function(t){var s=i("mvHQ"),a=i.n(s);e.a={data:function(){return{hasRes:!0,pageError:"暂无查询数据~~",list:[],searchKey:"",searchSort:"desc",defaultImg:'this.src="'+i("Mcun")+'"',pageno:1,showbigimg:"",isshowbigimg:!1}},computed:{author:function(){return this.$store.state.author}},mounted:function(){var t=this;this.getdata(),this.$nextTick(function(){t.init_datetimePicker()})},methods:{init_datetimePicker:function(){var e=this;t("#start").datetimePicker({title:"请选择时间",times:function(){return[]},parse:function(t){return t.split(/\D/).filter(function(e){return!!t})},onOpen:function(e){t("#start").val(e.value[0]+"-"+e.value[1]+"-"+e.value[2])},onChange:function(){console.log(e.datetime0)}}),t("#end").datetimePicker({title:"请选择时间",times:function(){return[]},parse:function(t){return t.split(/\D/).filter(function(e){return!!t})},onOpen:function(e){t("#end").val(e.value[0]+"-"+e.value[1]+"-"+e.value[2])}})},changeActive:function(e){t(".m-tab-dtl").eq(e).hasClass("check")?t(".m-tab-dtl").eq(e).removeClass("check"):t(".m-tab-dtl").eq(e).addClass("check")},searchfn:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getsort:function(t,e){this.searchKey=t,this.searchSort=e,this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata()},getdata:function(){var t=this,e=new D.FYBusiness("DOCUMENTARYTRACKINGLISTQRY"),i=e.addCreateService("DOCUMENTARYTRACKINGLISTQRY",!1),s=i.addCreateData();s.setValue("AS_USER_ID",localStorage.loginname),s.setValue("AS_DEPT_ID",""),s.setValue("AS_FUNC_NAME","DOCUMENTARYTRACKINGLISTQRY"),s.setValue("AS_CONDITION",t.searchKey),s.setValue("AS_SORT",t.searchSort),s.setValue("AS_OPRFLAG","1"),s.setValue("AN_PAGESIZE","20"),s.setValue("AN_PAGENO",t.pageno);var n=new D.InvokeProc;n.addBusiness(e),console.log(a()(n)),n.invoke(function(e){if("Y"==e.iswholeSuccess||"Y"==e.isAllBussSuccess){var s=i.getResult(e,"AC_RESULT").rows;console.log(s),0==s.length&&1==t.pageno?t.hasRes=!1:t.hasRes=!0,t.list=t.list.concat(s),t.$store.commit("ipdatestep1",s),t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad"),s.length<20&&t.pageno>1&&t.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone")}else console.log(e.errorMessage),t.ydui.alert({mes:e.errorMessage})})},loadList:function(){var t=this;console.error("执行了下拉刷新获取数据"),this.pageno=1,this.list=[],this.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),this.getdata(),setTimeout(function(){t.$refs.pullrefreshDemo.$emit("ydui.pullrefresh.finishLoad")},1e3)},loadLists:function(){console.log("滚动加载了"),this.pageno++,this.getdata()},goDetail:function(t,e,i){console.log(t),this.$router.push({path:"/stepdtl",query:{id:t,footId:"0",mainid:e,orderid:i}})},submit:function(){var e=this,i=[],s=[],n=[];if(t(".m-main .m-tab-dtl").each(function(){t(this).hasClass("check")&&(i.push(t(this).attr("data-id")),s.push(t(this).attr("data-mainid")),n.push(t(this).attr("data-orderid")))}),0==i.length)return this.ydui.alert({mes:"请先选择商品"}),!1;for(var l=new D.FYBusiness("DOCUMENTARYTRACKINGSAVE"),o=l.addCreateService("DOCUMENTARYTRACKINGSAVE",!1),r=[],c=0;c<i.length;c++){var u={};u.AS_USER_ID=localStorage.loginname,u.AS_DEPT_ID="",u.AS_FUNC_NAME="DOCUMENTARYTRACKINGSAVE",u.AS_DTLID=i[c],u.AS_MAINID=s[c],u.AS_ORDERID=n[c],u.AS_FABRICACTUALARRIVEDATE=t("#start").val(),u.AS_ACCESSORYACTUALARRIVEDATE=t("#end").val(),u.AS_OPRFLAG="1",r.push(u)}o.addDataArray(r);var d=new D.InvokeProc;d.addBusiness(l),console.log(a()(d)),d.invoke(function(i){"Y"==i.iswholeSuccess||"Y"==i.isAllBussSuccess?(e.ydui.alert({mes:"提交成功"}),e.$store.commit("upstate",""),console.log(e.$store.state.status.stepallsta),t(".m-main .m-tab-dtl").removeClass("check"),t("#start,#end").val(""),e.pageno=1,e.list=[],e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),e.getdata()):e.ydui.alert({mes:i.errorMessage})})},showimg:function(t){this.showbigimg=t,this.isshowbigimg=!0},closebigimg:function(){this.isshowbigimg=!1}}}}).call(e,i("7t+N"))},i9ua:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("Bp0h"),a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"yd-flexview"},[i("div",{staticClass:"g-scrollview"},[i("search",{attrs:{idx:1},on:{ongetdata:t.getsort,onsearch:t.searchfn}}),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"m-main os",staticStyle:{height:"-webkit-calc(100% - 280px)"}},[i("yd-pullrefresh",{ref:"pullrefreshDemo",attrs:{callback:t.loadList}},[i("yd-infinitescroll",{ref:"infinitescrollDemo",attrs:{callback:t.loadLists}},t._l(t.list,function(e,s){return i("yd-list",{key:s,attrs:{slot:"list",theme:"4"},slot:"list"},[t.hasRes?i("ul",{staticClass:"m-tab-cover m-tab-dtl",attrs:{"data-id":e.id,"data-mainid":e.mainid,"data-orderid":e.orderid}},[i("li",[i("img",{attrs:{slot:"img",src:e.mainpicurl,onerror:t.defaultImg},on:{click:function(i){t.showimg(e.mainpicurl)}},slot:"img"})]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.ordercode))]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.supplier))]),t._v(" "),i("li",{staticClass:"selflex",staticStyle:{color:"#3297fd"},on:{click:function(i){t.goDetail(e.id,e.mainid,e.orderid)}}},[i("u",[t._v(t._s(e.orderqty))])]),t._v(" "),i("li",{staticClass:"selflex",on:{click:function(e){t.changeActive(s)}}},[t._v(t._s(e.fabricarrivedate))])]):t._e()])}))],1),t._v(" "),t.hasRes?t._e():i("pageError",{attrs:{msg:t.pageError}})],1)],1),t._v(" "),t.isshowbigimg?i("div",{staticClass:"yd-lightbox",on:{click:t.closebigimg}},[i("img",{attrs:{src:t.showbigimg,onerror:t.defaultImg,alt:""},on:{click:t.closebigimg}})]):t._e(),t._v(" "),t._m(1),t._v(" "),i("div",{staticClass:"m-button"},[i("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("提交")])]),t._v(" "),i("foot",{attrs:{idx:0}})],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"m-tab m-tab-cover"},[i("li",[t._v("图片")]),t._v(" "),i("li",[t._v("追单编号")]),t._v(" "),i("li",[t._v("供应商")]),t._v(" "),i("li",[t._v("订货量")]),t._v(" "),i("li",[t._v("面料卡位时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",{staticClass:"m-time"},[e("li",[e("span",[this._v("面料实际到位时间")]),e("input",{staticClass:"yd-datetime-input",attrs:{type:"text",id:"start",readonly:"readonly",unselectable:"on",onfocus:"this.blur()",placeholder:""}})]),this._v(" "),e("li",[e("span",[this._v("辅料实际到位时间")]),e("input",{staticClass:"yd-datetime-input",attrs:{type:"text",id:"end",readonly:"readonly",unselectable:"on",onfocus:"this.blur()",placeholder:""}})])])}]},n=i("VU/8")(s.a,a,!1,null,null,null);e.default=n.exports}});