webpackJsonp([3],{PnzH:function(t,e,s){"use strict";(function(t){var i=s("mvHQ"),a=s.n(i);e.a={data:function(){return{idx:"",dtl:[],table:[],senddtl:[],isSend:!0,isSendDtl:!0,datetime0:"",datetime1:"",defaultImg:'this.src="'+s("Mcun")+'"',showbigimg:"",isshowbigimg:!1}},created:function(){this.init_datetimePicker()},mounted:function(){var e=this;console.log(this.$route.query);var s=this.$route.query.id,i=this.$route.query.footId;this.idx=i,this.getDtl(s),this.isSend="4"==i,"1"==i&&t(".scolpart").addClass("fisdtl"),t(".footer li").removeClass("on"),t(".footer li").eq(i).addClass("on"),this.$nextTick(function(){e.init_datetimePicker()})},methods:{init_datetimePicker:function(){t("#start").datetimePicker({title:"请选择时间",min:"1990-12-12",max:"2222-12-12 12:12",monthNames:"",times:function(){},parse:function(t){return t.split(/\D/).filter(function(e){return!!t})},onOpen:function(e){t("#state").val(e.value[0]+"-"+e.value[1]+"-"+e.value[2])}}),t("#end").datetimePicker({title:"请选择时间",min:"1990-12-12",max:"2222-12-12 12:12",monthNames:"",times:function(){},parse:function(t){return t.split(/\D/).filter(function(e){return!!t})},onOpen:function(e){t("#state").val(e.value[0]+"-"+e.value[1]+"-"+e.value[2])}})},submit:function(){console.log(this.idx);for(var e=this,s=new D.FYBusiness("DOCUMENTARYTRACKINGSAVE"),i=s.addCreateService("DOCUMENTARYTRACKINGSAVE",!1),n=[],d=0;d<1;d++){var l={};l.AS_USER_ID=localStorage.loginname,l.AS_DEPT_ID="",l.AS_FUNC_NAME="DOCUMENTARYTRACKINGSAVE",l.AS_DTLID=e.dtl[0].id,l.AS_MAINID=e.dtl[0].mainid,l.AS_ORDERID=e.dtl[0].orderid,l.AS_FABRICACTUALARRIVEDATE=t("#start").val(),l.AS_ACCESSORYACTUALARRIVEDATE=t("#end").val(),l.AS_OPRFLAG=Number(e.idx)+1,n.push(l)}i.addDataArray(n);var o=new D.InvokeProc;o.addBusiness(s),console.log(a()(o)),o.invoke(function(t){"Y"==t.iswholeSuccess||"Y"==t.isAllBussSuccess?e.ydui.alert({mes:"操作成功",callback:function(){e.$router.go(-1),e.$store.commit("backReload",!0),e.$store.commit("upstate","")}}):e.ydui.alert({mes:t.errorMessage})})},gotoEdit:function(e){var s=["update",this.dtl[0].mainid,t(".edit").eq(e).attr("data-sendbox"),t(".edit").eq(e).attr("data-sendqty"),t(".edit").eq(e).attr("data-imgurl")||""],i=s[0],a=s[1],n=s[2],d=s[3],l=s[4],o=t(".edit").eq(e).attr("data-dtlid"),r=t(".edit").eq(e).attr("data-id"),c=this.dtl[0].orderno,u=t(".edit").eq(e).attr("data-packingpic2");this.$router.push({path:"/edit",query:{footId:"4",type:i,id:r,mainid:a,sendqty:d,sendbox:n,imgurl:l,dtlid:o,orderno:c,packingpic2:u}})},addEdit:function(){var t=["add",this.dtl[0].id,this.dtl[0].mainid,this.dtl[0].orderno],e=t[0],s=t[1],i=t[2],a=t[3];this.$router.push({path:"/edit",query:{footId:"4",type:e,id:s,mainid:i,orderno:a}})},getDtl:function(t){var e=this,s=new D.FYBusiness("DOCUMENTARYTRACKINGDETAILQRY"),i=s.addCreateService("DOCUMENTARYTRACKINGDETAILQRY",!1),n=i.addCreateData();n.setValue("AS_USER_ID",localStorage.loginname),n.setValue("AS_DEPT_ID",""),n.setValue("AS_FUNC_NAME","DOCUMENTARYTRACKINGDETAILQRY"),n.setValue("AS_DTLID",t),n.setValue("AS_OPRFLAG",Number(e.idx)+1);var d=new D.InvokeProc;d.addBusiness(s),console.log(a()(d)),d.invoke(function(t){if("Y"==t.iswholeSuccess||"Y"==t.isAllBussSuccess){var s=i.getResult(t,"AC_RESULT1").rows,a=i.getResult(t,"AC_RESULT2").rows,n=i.getResult(t,"AC_RESULT3").rows,d=i.getResult(t,"AC_RESULT4").rows;console.error(s),console.error(a),console.error(n),console.error(d);for(var l=[],o=0;o<a.length;o++){var r={style:"",num:""},c=a[o].field;r.num=n[0][c],r.style=a[o].title,l.push(r)}0==d.length&&(e.isSendDtl=!1),e.dtl=s,e.table=l,e.senddtl=d,s[0].fabricactualarrivedate&&(e.datetime0=s[0].fabricactualarrivedate),s[0].accessoryactualarrivedate&&(e.datetime1=s[0].accessoryactualarrivedate)}else console.log(t.errorMessage),e.ydui.alert({mes:t.errorMessage})})},showbitimg:function(t){this.showbigimg=t,this.isshowbigimg=!0},closebigimg:function(){this.isshowbigimg=!1}}}}).call(e,s("7t+N"))},zmxc:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("PnzH"),a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"yd-flexview"},[s("div",{staticClass:"g-scrollview"},[s("dtl",{attrs:{items:t.dtl,table:t.table,senddtl:t.senddtl}}),t._v(" "),s("div",{staticClass:"scolpart",class:["fisdtl",{on:1===t.idx}]},[t._l(t.dtl,function(e){return s("ul",{key:t.dtl.id,staticClass:"dtlshtime"},[s("li",[s("span",[t._v("合同时间：")]),s("span",[t._v(t._s(e.contractdate))])]),t._v(" "),s("li",[s("span",[t._v("照片样时间：")]),s("span",[t._v(t._s(e.photodate))])]),t._v(" "),s("li",[s("span",[t._v("大货样时间：")]),s("span",[t._v(t._s(e.largecargodate))])]),t._v(" "),s("li",[s("span",[t._v("预估面料到位时间：")]),s("span",[t._v(t._s(e.estfabricarrivedate))])]),t._v(" "),s("li",[s("span",[t._v("面料卡位时间：")]),s("span",[t._v(t._s(e.fabricarrivedate))])]),t._v(" "),s("div",{staticClass:"glin"}),t._v(" "),"0"!=t.idx?s("li",{staticStyle:{"margin-top":"10px",color:"#1a1a1a"}},[s("span",[t._v("面料实际到位时间：")]),s("span",[t._v(t._s(e.fabricactualarrivedate))])]):t._e(),t._v(" "),"0"!=t.idx?s("li",{staticStyle:{color:"#1a1a1a"}},[s("span",[t._v("辅料实际到位时间：")]),s("span",[t._v(t._s(e.accessoryactualarrivedate))])]):t._e()])}),t._v(" "),t.isSend?s("div",[s("div",{staticClass:"glin"}),t._v(" "),t._l(t.dtl,function(e){return t.isSendDtl?s("div",{staticClass:"shownumxs"},[t._v("已发货数量："),s("span",[t._v(t._s(e.sendqty))]),t._v(" "),s("span",{staticStyle:{float:"right"}},[t._v("已发货箱数："+t._s(e.sendbox))])]):t._e()}),t._v(" "),t.isSendDtl?s("div",{staticClass:"showtable showfirst"},[s("span",[t._v("发货箱数")]),t._v(" "),s("span",[t._v("发货数量")]),t._v(" "),s("span",[t._v("发货时间")]),t._v(" "),s("span",[t._v("装箱单")]),t._v(" "),s("span",[t._v("操作")])]):t._e(),t._v(" "),t._l(t.senddtl,function(e,i){return s("yd-lightbox",{key:t.senddtl.id,staticClass:"showtable showsecond",staticStyle:{"border-top":"none"},attrs:{num:t.senddtl.length}},[s("span",[t._v(t._s(e.sendbox))]),t._v(" "),s("span",[t._v(t._s(e.sendqty))]),t._v(" "),s("span",[t._v(t._s(e.oprdatetime))]),t._v(" "),s("span",[s("img",{staticClass:"wcnmlgb",attrs:{slot:"img",src:e.packingpic,onerror:t.defaultImg},on:{click:function(s){t.showbitimg(e.packingpic)}},slot:"img"})]),t._v(" "),s("span",{staticClass:"edit",staticStyle:{color:"#3297fd"},attrs:{"data-footId":4,"data-dtlid":e.dtlid,"data-mainid":e.mainid,"data-id":e.id,"data-imgurl":e.packingpic,"data-packingpic2":e.packingpic2,"data-sendbox":e.sendbox,"data-sendqty":e.sendqty,"data-type":"update"},on:{click:function(e){t.gotoEdit(i)}}},[s("u",[t._v("编辑")])])])})],2):t._e()],2),t._v(" "),t.isshowbigimg?s("div",{staticClass:"yd-lightbox",on:{click:t.closebigimg}},[s("img",{attrs:{src:t.showbigimg,onerror:t.defaultImg,alt:""},on:{click:t.closebigimg}})]):t._e()],1),t._v(" "),"0"===t.idx?s("ul",{staticClass:"m-time"},[s("li",[s("span",[t._v("面料实际到位时间")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.datetime0,expression:"datetime0"}],staticClass:"yd-datetime-input",attrs:{id:"start"},domProps:{value:t.datetime0},on:{input:function(e){e.target.composing||(t.datetime0=e.target.value)}}})]),t._v(" "),s("li",[s("span",[t._v("辅料实际到位时间")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.datetime1,expression:"datetime1"}],staticClass:"yd-datetime-input",attrs:{id:"end"},domProps:{value:t.datetime1},on:{input:function(e){e.target.composing||(t.datetime1=e.target.value)}}})])]):t._e(),t._v(" "),"0"===t.idx?s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("提交")])]):"1"===t.idx?s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("开裁")])]):"2"===t.idx?s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("上线")])]):"3"===t.idx?s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.submit}},[t._v("后整")])]):s("div",{staticClass:"m-button"},[s("span",{staticClass:"m-but-master",on:{click:t.addEdit}},[t._v("发货")]),t._v(" "),s("span",{staticClass:"m-but-master",staticStyle:{"background-color":"#1664b3"},on:{click:t.submit}},[t._v("发货完全")])]),t._v(" "),s("foot",{attrs:{idx:0}})],1)},staticRenderFns:[]},n=s("VU/8")(i.a,a,!1,null,null,null);e.default=n.exports}});